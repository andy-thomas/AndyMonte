(function(a){var b=a.telerik;b.scripts.push("telerik.combobox.js");b.combobox=function(h,n){a.extend(this,n);var k=h.nodeName.toLowerCase()=="input"&&h.type.toLowerCase()=="text";var j=h.nodeName.toLowerCase()=="select";if((k||j)&&!a(h).parent().hasClass("t-combobox")){if(j&&!this.data){this.data=b.list.retrieveData(h)}var i=new b.list.htmlBuilder(h,"t-combobox",j);i.text=function(t){var s=t.builder;s.buffer=[];return a(s.cat('<input class="t-input" autocomplete="off" type="text" ').catIf('value="',t.text,'" ',t.text).catIf('name="',t.name,'-input" ',t.name).cat("/>").string())};i.render();if(j){h=h.previousSibling}}this.element=h;var p=this;var d=this.$element=a(h).closest("form").bind("reset",function(){setTimeout(function(){p.value(h.value)})}).end();this.loader=new b.list.loader(this);this.trigger=new b.list.trigger(this);var g=this.$wrapper=d.closest(".t-combobox");var e=this.$wrapper.find(".t-select");var f=this.$text=this.$wrapper.find("> .t-dropdown-wrap > .t-input").attr("autocomplete","off").bind("paste",a.proxy(function(s){setTimeout(a.proxy(function(){this.$element.val(s.target.value);o(this)},this),0)},this));var r=function(u){var s="class",t=d.attr(s)||"";if((u.attrName&&u.attrName==s)||(u.propertyName&&u.propertyName=="className")){if(t!=f.attr(s)){f.attr(s,t).addClass("t-input")}}};if(a.browser.msie){h.attachEvent("onpropertychange",r)}else{d.bind("DOMAttrModified",r)}d.closest("form").bind("reset",a.proxy(function(s){var t=this;window.setTimeout(function(){if(d.val()!=""){t.value(d.val())}else{t.highlight(0);t.selectedIndex=0}},1)},this));this.filtering=new b.list.filtering(this);this.filtering.autoFill=function(s,w){if(s.autoFill&&(s.lastKeyCode!=8&&s.lastKeyCode!=46)){var v=s.$text[0];var t=b.caretPos(v);var u=v.value.substring(0,t);var x=w.toLowerCase().indexOf(u.toLowerCase());if(x!=-1){var y=w.substring(x+u.length);v.value=u+y;b.list.selection(v,t,t+y.length)}}};this.dropDown=new b.dropDown({attr:this.dropDownAttr,effects:this.effects,onOpen:a.proxy(function(){var s=this.data;var t=this.dropDown;if(s.length==0){return}var v=this.$text.val();var u=this.selectedIndex;if(u!=-1&&this.isFiltered){if(v==s[u].Text){this.filteredDataIndexes=[];t.onItemCreate=null;if(this.filter){t.dataBind(this.data,this.encoded)}this.select(t.$items[u])}else{this.filters[this.filter](this,this.data,v)}this.isFiltered=false}},this),onClick:a.proxy(function(s){this.select(s.item);this.trigger.change();this.trigger.close();f.focus()},this)});this.dropDown.$element.css("direction",g.closest(".t-rtl").length?"rtl":"");this.enable=function(){g.removeClass("t-state-disabled");f.removeAttr("disabled");d.removeAttr("disabled");if(!e.data("events")){e.bind("click",a.proxy(q,this))}};this.disable=function(){g.addClass("t-state-disabled");f.attr("disabled","disabled");d.attr("disabled","disabled");e.unbind("click")};this[this.enabled?"enable":"disable"]();this.fill=function(s){function z(C){var G=C.selectedValue||C.value();if(G){C.value(G);return}var A=t.$items;var E=C.index;var B=A.filter(".t-state-selected");var F=B.length;var D=E!=-1&&E<A.length?A[E]:F>0?B[F-1]:null;if(D){C.select(D)}else{C.selectedIndex=-1;if(C.highlightFirst){C.highlight(A[0])}}}var u=this.loader;var t=this.dropDown;var v=this.minChars;var x=this.text();var y=x.length;if(!t.$items&&!u.ajaxError){if((u.isAjax()||this.onDataBinding)&&y>=v){var w={};w[this.queryString.text]=x;u.ajaxRequest(function(A){this.dataBind(A,true);z(this);b.trigger(this.element,"dataBound");this.trigger.change();if(s){s()}},{data:w})}else{this.dataBind(this.data,true);z(this);if(s){s()}}}};this.reload=function(){this.dropDown.$items=null;this.fill()};this.select=function(v){var u=this.highlight(v);if(u!=-1){var t=this.filteredDataIndexes;this.selectedIndex=(t&&t.length)>0?t[u]:u;var s=this.data[this.selectedIndex];b.list.updateTextAndValue(this,s.Text,s.Value)}return u};this.text=function(){return this.$text.val.apply(this.$text,arguments)};this.value=function(){if(arguments.length){var t=arguments[0];var s=this.select(function(u){return t==(u.Value||u.Text)});if(s==-1){this.selectedIndex=s;this.$element.val(t);this.text(t)}this.previousValue=this.$element.val()}else{return this.$element.val()}};b.list.common.call(this);b.list.filters.call(this);b.list.initialize.call(this);a(document.documentElement).bind("mousedown",a.proxy(function(u){var s=this.dropDown.$element;var v=s&&s.parent().length>0;if(a.contains(this.$wrapper[0],u.target)||(v&&a.contains(s.parent()[0],u.target))){return}if(this._textChanged){this._textChanged=false;var t=c(this.data,this.$text.val());if(t){this.text(t.Text);this.$element.val(t.Value||t.Text)}}this.trigger.change();this.trigger.close()},this));this.$text.bind({keydown:a.proxy(l,this),keypress:a.proxy(m,this),focus:a.proxy(function(u){if(this.openOnFocus){var v=this.trigger;var t=this.dropDown;if(!t.$items){this.fill(v.open)}else{v.open()}}var s=this.$text;clearTimeout(this.selectTextTimeout);this.selectTextTimeout=window.setTimeout(function(){b.list.selection(s[0],0,s.val().length)},130)},this),blur:a.proxy(function(){clearTimeout(this.selectTextTimeout)},this)});function q(t){var s=this.dropDown,u=this.trigger;this.loader.ajaxError=false;if(!s.isOpened()){if(!s.$items){this.fill(u.open)}else{u.open()}f[0].focus()}else{u.close()}}function o(s){clearTimeout(s.timeout);s.timeout=setTimeout(function(){s.filtering.filter(s)},s.delay)}function l(x){var A=this.trigger;var w=this.dropDown;var y=x.keyCode||x.which;this.lastKeyCode=y;if(x.altKey){if(y==38||y==40){var u=y==38?A.close:A.open;if(!w.$items){this.fill(u)}else{u()}}return}if(!x.shiftKey&&(y==38||y==40)){x.preventDefault();var z=a.proxy(function(){var C=w.$items,D=C.filter(".t-state-selected:first");var B=D.length==0||C.length==1||this.selectedIndex==-1?C.first():(y==38)?D.prev():(y==40)?D.next():[];if(B.length){var E=B[0];this.select(E);w.scrollTo(E);if(!w.isOpened()){A.change()}}},this);if(!w.$items){if(this.index!=-1||this.value()||this.selectedValue){z=null}this.fill(z);return}z();return}if(y==8||y==46||(x.ctrlKey&&y==88)){var t=this.$text;if(t.val()!=""){o(this)}setTimeout(a.proxy(function(){if(t.val()==""){this.selectedIndex=-1;this.$element.val("")}else{this.$element.val(this.$text.val())}},this),0);return}if(y==13){if(w.isOpened()){x.preventDefault();var s=w.$items.filter(".t-state-selected:first");if(s.length>0){this.select(s[0])}else{this.$element.val(this.$text.val())}A.change();A.close();b.list.moveToEnd(this.$text[0])}return}if(y==27||y==9){clearTimeout(this.timeout);var v=c(this.data,this.$text.val());if(v){this.text(v.Text);this.$element.val(v.Value||v.Text)}A.change();A.close();if(y==27){this.$text.blur()}return}o(this)}function m(s){this._textChanged=true;var t=s.keyCode||s.charCode;if(!s.shiftKey&&(t==0||a.inArray(t,b.list.keycodes)!=-1||s.ctrlKey)){return true}setTimeout(a.proxy(function(){this.$element.val(this.$text.val())},this),0)}};function c(d,g){if(!g){return}g=g.toLowerCase();if(d){for(var f=0,h=d.length;f<h;f++){var e=d[f],j=e.Text;if(j.toLowerCase()==g){return e}}}}a.fn.tComboBox=function(d){return b.create(this,{name:"tComboBox",init:function(e,f){return new b.combobox(e,f)},options:d})};a.fn.tComboBox.defaults={encoded:true,openOnFocus:false,effects:b.fx.slide.defaults(),index:-1,autoFill:true,highlightFirst:true,filter:0,delay:200,minChars:0,enabled:true,cache:true,queryString:{text:"text"}}})(jQuery);